<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pricing Table</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 20px;
    }

    select {
      padding: 8px 16px;
      font-size: 16px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-left: 10px;
      margin-right: 20px;
      cursor: pointer;
      background: #ffffff;
      color: #000;
      width: auto;
      display: inline-block;
    }

    .dropdown-container {
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 20px;
      color: #fff;
      text-align: center;
    }

    .dropdown-label {
      display: inline-block;
      margin-right: 20px;
    }

    .dropdown-block {
      margin-bottom: 20px;
      margin-right: 20px;
    }

    .svcPtlPopup-hidden {
      display: none;
    }

    .pricing-table {
      display: flex;
      justify-content: space-between;
      padding: 20px 0;
      max-width: 100%;
      margin: 20px auto;
      flex-wrap: wrap;
    }

    .pricing-col {
      border: 1px solid #ddd;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease-in-out;
      background-color: #000;
      color: #ffffff;
      position: relative;
      height: auto;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      border-radius: 10px;
      margin: 10px;
      flex: 0 1 100%;
    }

    .discount-tab {
      background-color: green;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
      width: auto;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }

    .pricing-col:hover {
      border-color: rgba(0, 0, 0, 0.3);
      box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.2);
    }

    .pricing-img {
      width: 100%;
      height: auto;
      min-height: 100px;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      margin-bottom: 20px;
    }

    h2 {
      font-size: 18px;
      margin-top: 15px;
    }

    .btn {
      padding: 8px 16px;
      border: none;
      background-color: #333;
      color: #fff;
      border-radius: 4px;
      font-weight: bold;
      text-decoration: none;
      transition: background-color 0.3s ease-in-out;
      width: 90%;
      height: 50px;
      text-align: center;
      margin: 10px auto;
      display: block;
      cursor: pointer;
      font-size: 16px;
    }

    .btn:hover {
      background-color: green;
    }

    .svcPtlPopup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #333;
      color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      width: 100%;
      max-width: 350px;
      min-width: 200px;
      text-align: center;
    }

    a {
      text-decoration: none;
    }

    .svcPtlPopup button {
      padding: 8px 16px;
      margin: 10px 0;
      border: none;
      background-color: #64a70b;
      color: #fff;
      border-radius: 4px;
      font-weight: bold;
      text-decoration: none;
      transition: background-color 0.3s ease-in-out;
      width: 80%;
      text-align: center;
      display: block;
      cursor: pointer;
    }

    .svcPtlPopup button:hover {
      background-color: green;
    }

    .svcPtlPopup button:disabled {
      background-color: grey;
    }

    .svcPtlPopup input {
      width: 100%;
      height: 30px;
      padding: 8px 16px;
      font-size: 16px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-left: 10px;
      cursor: pointer;
      background: #ffffff;
      color: #000;
      width: auto;
      display: inline-block;
    }

    .svcPtlPopup-close {
      position: absolute;
      top: 10px;
      right: 10px;
      cursor: pointer;
      color: #fff;
      font-size: 20px;
    }

    .svcPtlPopup #cancel,
    .svcPtlPopup #submit {
      width: 150px;
      border-radius: 4px;
      height: 50px;
    }

    .svcPtlPopup #errorSpan {
      color: red;
    }

    .svcPtlPopup-button-div {
      display: flex;
      justify-content: space-around;
    }

    @media screen and (max-width: 600px) {
      body {
        padding: 10px;
      }

      .pricing-col {
        flex-basis: 100%;
        margin: 5px;
      }

      h2 {
        font-size: 16px;
      }

      .btn {
        width: 100%;
      }
    }

    @media screen and (min-width: 601px) and (max-width: 900px) {

      .pricing-col {
        flex-basis: 50%;
      }
    }

    @media screen and (min-width: 901px) and (max-width: 1024px) {

      .pricing-col {
        flex: 1;
      }
    }

    @media screen and (min-width: 1025px) {

      .pricing-col {
        flex: 1;
      }
    }
  </style>

</head>

<body>
  <div class="dropdown-container">
    <div class="dropdown-block">
      <div class="dropdown-label">Already have a Bluetooth Module?</div>
      <select id="moduleSelect">
        <option value="no" selected>No</option>
        <option value="yes">Yes</option>
      </select>
    </div>

    <div class="dropdown-block">
      <div class="dropdown-label">Plan Duration:</div>
      <select id="planSelect">
        <option value="monthly">Monthly</option>
        <option value="yearly" selected>Yearly</option>
      </select>
      <span id="infoIcon" style="cursor: pointer;"
        title="Please note for subscription purchases, we currently offer only yearly billing plans through a GE Appliances account. For monthly billing plans, we kindly request you to proceed with the purchase using a credit card through our secure Stripe portal.">&#9432;</span>
    </div>

    <!-- Pricing Table -->
    <div class="pricing-table" id="pricingTable"></div>
    <div class="svcPtlPopup-overlay"></div>
    <div class="svcPtlPopup">
      <div class="svcPtlPopup-close">X</div>
      <div class="svcPtlPopup-content" id="svcPtlPopupContect"></div>
    </div>
    <script>
      let buyNowButtonClickListener;
      let moduleSelect = document.getElementById("moduleSelect");
      let planSelect = document.getElementById("planSelect");
      let pricingTable = document.getElementById("pricingTable");
      let popupContect = document.getElementById("svcPtlPopupContect");
      let validCode = false;

      function openPopup(isModuleIncluded, isYearly) {
        // Determine the correct links based on the user's selections
        let partsLink = "https://forms.smarthqpro.com/parts";
        let creditCardLink;
        if (isModuleIncluded) {
          if (isYearly) {
            creditCardLink = "https://buy.stripe.com/5kAcQpa3BeobcWkfZq";
          } else {
            creditCardLink = "https://buy.stripe.com/6oE6s1fnVa7V7C04gt";
          }
        } else {
          if (isYearly) {
            creditCardLink = "https://buy.stripe.com/7sI5nX4JheobbSg4gH";
          } else {
            creditCardLink = "https://buy.stripe.com/00g8A98Zxdk71dC4gC";
          }
        }

        popupContect.innerHTML = `
          <h3>Already a Customer?</h3>
          <p>To add this purchase to your account, please access your customer portal by clicking <a href="${partsLink}" style="color: #97D700;">HERE</a>.</p>
          <p>If youâ€™re new here, please click the 'Continue' button below to finalize your purchase.</p>
          <button id="continueButton">CONTINUE</button>`;

        // Display the popup
        document.querySelector(".svcPtlPopup").style.display = "block";
        document.querySelector(".svcPtlPopup-overlay").style.display = "block";

        document.getElementById("continueButton").onclick = () => {
          window.location.href = creditCardLink;
        };
      }

      function closePopup() {
        document.querySelector(".svcPtlPopup").style.display = "none";
        document.querySelector(".svcPtlPopup-overlay").style.display = "none";
      }

      function generateTable() {
        let module = moduleSelect.value;
        let monthly = planSelect.value === "monthly";
        let modulePrice = 199;
        let subscriptionPrice;
        let creditCardLink;
        if (module === "no") {
          if (!monthly) {
            creditCardLink = "https://buy.stripe.com/5kAcQpa3BeobcWkfZq";
          } else {
            creditCardLink = "https://buy.stripe.com/6oE6s1fnVa7V7C04gt";
          }
        } else {
          if (!monthly) {
            creditCardLink = "https://buy.stripe.com/7sI5nX4JheobbSg4gH";
          } else {
            creditCardLink = "https://buy.stripe.com/00g8A98Zxdk71dC4gC";
          }
        }

        if (monthly) {
          // Monthly pricing remains the same
          subscriptionPrice = 55;
        } else {
          // Yearly pricing
          subscriptionPrice = 600;
        }

        let moduleImgSrc =
          module === "yes"
            ? "https://uploads-ssl.webflow.com/61d5fc96029694ef0cf8f249/63ff0b4f20f51d2091c6f26a_SmartHQ%20Pro%20Interface-6.png"
            : "https://uploads-ssl.webflow.com/61d5fc96029694ef0cf8f249/644fcc6f17b2c36472c32fc2_SmartHQ%20Service%20Interface.png";

        // Generate the HTML for the pricing table
        pricingTable.innerHTML = `
              <div class="pricing-col" style="border-color: #97D700;">
              <button class="discount-tab">10% off on yearly plan</button>
                  <div class="pricing-img" style="background-image: url('${moduleImgSrc}');"></div>
                  <h2>SmartHQ Service${module === "no" ? " + Module" : ""}</h2>
                  <div style="font-size: 40px; margin-bottom: 20px; color: #97D700; font-weight: bold;">
                      $${subscriptionPrice} ${monthly ? "/month" : "/year"}
                  </div>
                  ${module === "no"
                    ? `<div style="font-size: 18px; margin-bottom: 20px;">*Excludes a one-time module cost of $${modulePrice}.</div>`
                    : ""
                  }
                  <button class="btn" id="sButton" style="background-color: #64A70B;" onclick="openPopup(${module === 'yes'}, ${!monthly})">Buy Now</button>
              </div>
          `;

      }

      moduleSelect.addEventListener("change", generateTable);
      planSelect.addEventListener("change", generateTable);

      document
        .querySelector(".svcPtlPopup-close")
        .addEventListener("click", closePopup);

      document
        .querySelector(".svcPtlPopup-overlay")
        .addEventListener("click", closePopup);

      window.onload = generateTable();
      window.addEventListener("pageshow", function (event) {
        console.log(event);
        if (
          event.persisted ||
          (window.performance && window.performance.navigation.type === 2)
        ) {
          // Run your function here
          generateTable();
        }
      });

    </script>
</body>

</html>
